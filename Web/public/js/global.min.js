wf.define("meetingTime",[],function(){return function(){var f=8,i=17,n=10,t=":",r='<li data-value="{0}" class="wf-select-option {2}">{1}<\/li>',u=function(){return{toTime:n=>{var i=n%60;return Math.floor(n/60)+t+(i<10?"0"+i:i)},toMinutes:n=>{var i=n.split(t);return parseInt(i[0])*60+parseInt(i[1])}}}();return{render:function(e,o){var a=[],h=new Date,v=h.getHours(),b=h.getMinutes(),y=24,p=60,w=h.format("yyyy-MM-dd")==e,c,s,l;if(v>=i&&w)return r.format("","下班");for(o&&(c=o.split(t),y=parseInt(c[0]),p=parseInt(c[1])),s=w?Math.min(v,y)*60+Math.ceil(Math.min(b,p)/n)*n:f*60;s<=i*60;s=s+n)l=u.toTime(s),a.push(r.format(l,l,s===u.toMinutes(o)?"wf-select-option-selected":""));return a.join("")}}}()});wf.define("meeting",[],function(){return(()=>{var n=(n,t,i)=>{$.post(n,t,n=>{$.isFunction(i)&&i(n)})};return{save:(t,i)=>{n("meeting/save",t,i)},remove:(t,i)=>{n("meeting/delete",{id:t},i)}}})()});wf.define("meetingCheck",[],function(){return function(){var n=function(n){return n.substring(0,1)>1&&(n="0"+n),n};return{check:function(t,i){return(t.startTime=n(t.startTime),t.endTime=n(t.endTime),i.startTime=n(i.startTime),i.endTime=n(i.endTime),t.endTime<=t.startTime)?!1:t.date==i.date&&t.tableRoom==i.tableRoom?t.startTime>=i.endTime||t.endTime<=i.startTime?!0:!1:!0}}}});wf.define("meetingSort",[],function(){return function(){var n=function(n){return n.substring(0,1)>1&&(n="0"+n),n};return{sort:function(t,i){return t.startTime=n(t.startTime),i.startTime=n(i.startTime),t.startTime<=i.startTime?!0:!1}}}});wf.define("meetingCard",[],function(){var n=wf.require("meeting"),t=wf.require("meetingTime"),i=wf.require("meetingCheck"),r=wf.require("meetingSort");return function(u,f,e){var o=f.find(".meeting-save"),p=f.find(".meeting-delete"),w=f.find(".meeting-startTime"),b=f.find(".meeting-endTime"),g=$(".meeting-date"),a="meeting-saved",v="meeting-edit",h="meeting-editing",c=".meeting-list-wrapper",l="meeting-error",s=n=>f.find('[name="{0}"]'.format(n)),y=function(n){return n.substring(0,1)>1&&(n="0"+n),n},k=function(){var t=["tableRoom","startTime","endTime"],n=[];return o.parents(".meeting-card").siblings(".meeting-saved").each(function(){var r=[],u={date:e},i;for($(this).find(".wf-select-input").each(function(){var n=$(this);r.push(n.val())}),i=0;i<r.length;i++)u[t[i]]=r[i];n.push(u)}),n},d=function(){var t={},n={date:e},f,a,u;if(["id","title","userName","tableRoom","startTime","endTime"].forEach(n=>{t[n]=s(n)}),!t.title.val())return t.title.focus(),null;if(!t.userName.val())return t.userName.focus(),null;for(f in t)n[f]=t[f].val();var v=i(),p=r(),h=k(),c=!0;if(n.startTime=y(n.startTime),n.endTime=y(n.endTime),n.endTime<=n.startTime){c=!1;a=o.parent().prev().find(".wf-select-selection").addClass(l);setTimeout(function(){a.removeClass(l)},2e3);return}for(u=0;u<h.length;u++)v.check(n,h[u])?p.sort(n,h[u])?o.parent().parent().prev(".meeting-card").before(o.parent().parent()):o.parent().parent().next(".meeting-card").after(o.parent().parent()):(c=!1,o.parent().parent().addClass(l),setTimeout(function(){o.parent().parent().removeClass(l)},2e3));if(c)return n};return w.find(".time-option").html(t.render(e,s("startTime").val())),b.find(".time-option").html(t.render(e,s("endTime").val())),o.click(function(){var t=d();t&&n.save(t,n=>{n.success?(t.id||s("id").val(n.id),o.parent().parent().addClass(a),f.closest(c).removeClass(h)):$("#message-trigger").click()})}),p.click(function(){var t=s("id").val(),i=function(){f.closest(c).removeClass(h);f.remove()};t?n.remove(t,n=>{n.success&&i()}):i()}),f.hover(function(){$(this).hasClass(a)&&$(this).find("."+v).show()},function(){$(this).find("."+v).hide()}),f.find("."+v+" .wf-btn").click(function(){f.removeClass(a).closest(c).addClass(h);$(this).parent().hide()}),{addTo:function(n){n.append(f);f.closest(c).addClass(h)}}}});wf.require("page").render("meetingBorad",["UI.Select","UI.Modal"],function(){var n=this,t="meeting-temp",i=wf.require("meetingCard"),r=$("."+t).remove().removeClass(t),u;r.find("[data-rendered]").removeAttr("data-rendered");$(".meeting-add").click(function(){var t=$(this),u=r.clone(),f=t.prev().find(".meeting-date").html(),e=i(t,u,f);e.addTo(t.prev());n.refresh()});u=$(".meeting-board-wrapper").find(".meeting-card");$.each(u,function(){i("",$(this),$(this).parent().find(".meeting-date").html())});n.refresh()});